{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\nextjs-ecommerce-master\\\\pages\\\\index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport Head from 'next/head';\nimport { useState, useContext, useEffect } from 'react';\nimport { DataContext } from '../store/GlobalState';\nimport Featured from '../components/Featured';\nimport ProductItem from '../components/product/ProductItem';\nimport filterSearch from '../utils/filterSearch';\nimport { useRouter } from 'next/router';\nimport Filter from '../components/Filter';\nimport Service from '../components/Service';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Home = function Home(props) {\n  _s();\n\n  var _useState = useState(props.products),\n      products = _useState[0],\n      setProducts = _useState[1];\n\n  var _useState2 = useState(false),\n      isCheck = _useState2[0],\n      setIsCheck = _useState2[1];\n\n  var _useState3 = useState(1),\n      page = _useState3[0],\n      setPage = _useState3[1];\n\n  var router = useRouter();\n\n  var _useContext = useContext(DataContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var auth = state.auth;\n  useEffect(function () {\n    setProducts(props.products);\n  }, [props.products]);\n  useEffect(function () {\n    if (Object.keys(router.query).length === 0) setPage(1);\n  }, [router.query]);\n\n  var handleCheck = function handleCheck(id) {\n    products.forEach(function (product) {\n      if (product._id === id) product.checked = !product.checked;\n    });\n    setProducts(_toConsumableArray(products));\n  };\n\n  var handleCheckALL = function handleCheckALL() {\n    products.forEach(function (product) {\n      return product.checked = !isCheck;\n    });\n    setProducts(_toConsumableArray(products));\n    setIsCheck(!isCheck);\n  };\n\n  var handleDeleteAll = function handleDeleteAll() {\n    var deleteArr = [];\n    products.forEach(function (product) {\n      if (product.checked) {\n        deleteArr.push({\n          data: '',\n          id: product._id,\n          title: 'Delete all selected products?',\n          type: 'DELETE_PRODUCT'\n        });\n      }\n    });\n    dispatch({\n      type: 'ADD_MODAL',\n      payload: deleteArr\n    });\n  };\n\n  var handleLoadmore = function handleLoadmore() {\n    setPage(page + 1);\n    filterSearch({\n      router: router,\n      page: page + 1\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home_page\",\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Home Page\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Featured, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Service, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(NewsList, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Filter, {\n      state: state\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, _this), auth.user && auth.user.role === 'admin' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"delete_all btn btn-danger mt-2\",\n      style: {\n        marginBottom: '-10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        checked: isCheck,\n        onChange: handleCheckALL,\n        style: {\n          width: '25px',\n          height: '25px',\n          transform: 'translateY(8px)'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-danger ml-2\",\n        \"data-toggle\": \"modal\",\n        \"data-target\": \"#exampleModal\",\n        onClick: handleDeleteAll,\n        children: \"DELETE ALL\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"products\",\n      children: products.length === 0 ? /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"No Products\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }, _this) : products.map(function (product) {\n        return /*#__PURE__*/_jsxDEV(ProductItem, {\n          product: product,\n          handleCheck: handleCheck\n        }, product._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, _this), props.result < page * 6 ? \"\" : /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-outline-info d-block mx-auto mb-4\",\n      onClick: handleLoadmore,\n      children: \"Load more\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Home, \"AB9Pyf311dAufw37uxHYjJsb0m4=\", false, function () {\n  return [useRouter];\n});\n\n_c = Home;\nexport var __N_SSP = true;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["Head","useState","useContext","useEffect","DataContext","Featured","ProductItem","filterSearch","useRouter","Filter","Service","Home","props","products","setProducts","isCheck","setIsCheck","page","setPage","router","state","dispatch","auth","Object","keys","query","length","handleCheck","id","forEach","product","_id","checked","handleCheckALL","handleDeleteAll","deleteArr","push","data","title","type","payload","handleLoadmore","user","role","marginBottom","width","height","transform","map","result"],"sources":["C:/Users/DELL/Desktop/nextjs-ecommerce-master/pages/index.js"],"sourcesContent":["import Head from 'next/head'\nimport { useState, useContext, useEffect } from 'react'\nimport {DataContext} from '../store/GlobalState'\nimport Featured from '../components/Featured'\nimport { getData } from '../utils/fetchData'\nimport ProductItem from '../components/product/ProductItem'\nimport filterSearch from '../utils/filterSearch'\nimport {useRouter} from 'next/router'\nimport Filter from '../components/Filter'\nimport Service from '../components/Service'\nconst Home = (props) => {\n  const [products, setProducts] = useState(props.products)\n\n  const [isCheck, setIsCheck] = useState(false)\n  const [page, setPage] = useState(1)\n  const router = useRouter()\n\n  const {state, dispatch} = useContext(DataContext)\n  const {auth} = state\n\n  useEffect(() => {\n    setProducts(props.products)\n  },[props.products])\n\n  useEffect(() => {\n    if(Object.keys(router.query).length === 0) setPage(1)\n  },[router.query])\n\n  const handleCheck = (id) => {\n    products.forEach(product => {\n      if(product._id === id) product.checked = !product.checked\n    })\n    setProducts([...products])\n  }\n\n  const handleCheckALL = () => {\n    products.forEach(product => product.checked = !isCheck)\n    setProducts([...products])\n    setIsCheck(!isCheck)\n  }\n\n  const handleDeleteAll = () => {\n    let deleteArr = [];\n    products.forEach(product => {\n      if(product.checked){\n          deleteArr.push({\n            data: '', \n            id: product._id, \n            title: 'Delete all selected products?', \n            type: 'DELETE_PRODUCT'\n          })\n      }\n    })\n\n    dispatch({type: 'ADD_MODAL', payload: deleteArr})\n  }\n\n  const handleLoadmore = () => {\n    setPage(page + 1)\n    filterSearch({router, page: page + 1})\n  }\n\n  return(\n    <div className=\"home_page\">\n      <Head>\n        <title>Home Page</title>\n      </Head>\n      <Featured />\n      <Service/>\n      <NewsList/>\n      <Filter state={state} />\n\n      {\n        auth.user && auth.user.role === 'admin' &&\n        <div className=\"delete_all btn btn-danger mt-2\" style={{marginBottom: '-10px'}}>\n          <input type=\"checkbox\" checked={isCheck} onChange={handleCheckALL}\n          style={{width: '25px', height: '25px', transform: 'translateY(8px)'}} />\n\n          <button className=\"btn btn-danger ml-2\"\n          data-toggle=\"modal\" data-target=\"#exampleModal\"\n          onClick={handleDeleteAll}>\n            DELETE ALL\n          </button>\n        </div>\n      }\n\n      <div className=\"products\">\n        {\n          products.length === 0 \n          ? <h2>No Products</h2>\n\n          : products.map(product => (\n            <ProductItem key={product._id} product={product} handleCheck={handleCheck} />\n          ))\n        }\n      </div>\n      \n      {\n        props.result < page * 6 ? \"\"\n        : <button className=\"btn btn-outline-info d-block mx-auto mb-4\"\n        onClick={handleLoadmore}>\n          Load more\n        </button>\n      }\n    \n    </div>\n  )\n}\n\n\nexport async function getServerSideProps({query}) {\n  const page = query.page || 1\n  const category = query.category || 'all'\n  const sort = query.sort || ''\n  const search = query.search || 'all'\n\n  const res = await getData(\n    `product?limit=${page * 6}&category=${category}&sort=${sort}&title=${search}`\n  )\n  // server side rendering\n  return {\n    props: {\n      products: res.products,\n      result: res.result\n    }, // will be passed to the page component as props\n  }\n}\n\nexport default Home"],"mappings":"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"},"metadata":{},"sourceType":"module"}