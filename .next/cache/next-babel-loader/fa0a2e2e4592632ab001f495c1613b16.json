{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport Users from '../models/userModel';\n\nconst auth = async (req, res) => {\n  const token = req.headers.authorization;\n  if (!token) return res.status(400).json({\n    err: 'Invalid Authentication.'\n  });\n  const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET);\n  if (!decoded) return res.status(400).json({\n    err: 'Invalid Authentication.'\n  });\n  const user = await Users.findOne({\n    _id: decoded.id\n  });\n  return {\n    id: user._id,\n    role: user.role,\n    root: user.root\n  };\n};\n\nexport default auth;","map":{"version":3,"names":["jwt","Users","auth","req","res","token","headers","authorization","status","json","err","decoded","verify","process","env","ACCESS_TOKEN_SECRET","user","findOne","_id","id","role","root"],"sources":["C:/Users/DELL/Desktop/nextjs-ecommerce-master/middleware/auth.js"],"sourcesContent":["import jwt from 'jsonwebtoken'\nimport Users from '../models/userModel'\n\n\nconst auth = async (req, res) => {\n    const token = req.headers.authorization;\n    if(!token) return res.status(400).json({err: 'Invalid Authentication.'})\n\n    const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET)\n    if(!decoded) return res.status(400).json({err: 'Invalid Authentication.'})\n\n    const user = await Users.findOne({_id: decoded.id})\n\n    return {id: user._id, role: user.role, root: user.root};\n}\n\n\nexport default auth"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;;AAGA,MAAMC,IAAI,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;EAC7B,MAAMC,KAAK,GAAGF,GAAG,CAACG,OAAJ,CAAYC,aAA1B;EACA,IAAG,CAACF,KAAJ,EAAW,OAAOD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;IAACC,GAAG,EAAE;EAAN,CAArB,CAAP;EAEX,MAAMC,OAAO,GAAGX,GAAG,CAACY,MAAJ,CAAWP,KAAX,EAAkBQ,OAAO,CAACC,GAAR,CAAYC,mBAA9B,CAAhB;EACA,IAAG,CAACJ,OAAJ,EAAa,OAAOP,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;IAACC,GAAG,EAAE;EAAN,CAArB,CAAP;EAEb,MAAMM,IAAI,GAAG,MAAMf,KAAK,CAACgB,OAAN,CAAc;IAACC,GAAG,EAAEP,OAAO,CAACQ;EAAd,CAAd,CAAnB;EAEA,OAAO;IAACA,EAAE,EAAEH,IAAI,CAACE,GAAV;IAAeE,IAAI,EAAEJ,IAAI,CAACI,IAA1B;IAAgCC,IAAI,EAAEL,IAAI,CAACK;EAA3C,CAAP;AACH,CAVD;;AAaA,eAAenB,IAAf"},"metadata":{},"sourceType":"module"}