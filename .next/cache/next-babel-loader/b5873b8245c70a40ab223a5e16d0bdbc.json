{"ast":null,"code":"import connectDB from '../../../utils/connectDB';\nimport Users from '../../../models/userModel';\nimport auth from '../../../middleware/auth';\nimport bcrypt from 'bcrypt';\nconnectDB();\nexport default (async (req, res) => {\n  switch (req.method) {\n    case \"PATCH\":\n      await resetPassword(req, res);\n      break;\n  }\n});\n\nconst resetPassword = async (req, res) => {\n  try {\n    const result = await auth(req, res);\n    const {\n      password\n    } = req.body;\n    const passwordHash = await bcrypt.hash(password, 12);\n    await Users.findOneAndUpdate({\n      _id: result.id\n    }, {\n      password: passwordHash\n    });\n    res.json({\n      msg: \"Update Success!\"\n    });\n  } catch (err) {\n    return res.status(500).json({\n      err: err.message\n    });\n  }\n};","map":{"version":3,"names":["connectDB","Users","auth","bcrypt","req","res","method","resetPassword","result","password","body","passwordHash","hash","findOneAndUpdate","_id","id","json","msg","err","status","message"],"sources":["C:/Users/DELL/Desktop/nextjs-ecommerce-master/pages/api/user/resetPassword.js"],"sourcesContent":["import connectDB from '../../../utils/connectDB'\nimport Users from '../../../models/userModel'\nimport auth from '../../../middleware/auth'\nimport bcrypt from 'bcrypt'\n\nconnectDB()\n\nexport default async (req, res) => {\n    switch(req.method){\n        case \"PATCH\":\n            await resetPassword(req, res)\n            break;\n    }\n}\n\n\nconst resetPassword = async (req, res) => {\n    try {\n        const result = await auth(req, res)\n        const { password } = req.body\n        const passwordHash = await bcrypt.hash(password, 12)\n\n        await Users.findOneAndUpdate({_id: result.id}, {password: passwordHash})\n\n        res.json({ msg: \"Update Success!\"})\n        \n    } catch (err) {\n        return res.status(500).json({err: err.message})\n    }   \n}"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,0BAAtB;AACA,OAAOC,KAAP,MAAkB,2BAAlB;AACA,OAAOC,IAAP,MAAiB,0BAAjB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEAH,SAAS;AAET,gBAAe,OAAOI,GAAP,EAAYC,GAAZ,KAAoB;EAC/B,QAAOD,GAAG,CAACE,MAAX;IACI,KAAK,OAAL;MACI,MAAMC,aAAa,CAACH,GAAD,EAAMC,GAAN,CAAnB;MACA;EAHR;AAKH,CAND;;AASA,MAAME,aAAa,GAAG,OAAOH,GAAP,EAAYC,GAAZ,KAAoB;EACtC,IAAI;IACA,MAAMG,MAAM,GAAG,MAAMN,IAAI,CAACE,GAAD,EAAMC,GAAN,CAAzB;IACA,MAAM;MAAEI;IAAF,IAAeL,GAAG,CAACM,IAAzB;IACA,MAAMC,YAAY,GAAG,MAAMR,MAAM,CAACS,IAAP,CAAYH,QAAZ,EAAsB,EAAtB,CAA3B;IAEA,MAAMR,KAAK,CAACY,gBAAN,CAAuB;MAACC,GAAG,EAAEN,MAAM,CAACO;IAAb,CAAvB,EAAyC;MAACN,QAAQ,EAAEE;IAAX,CAAzC,CAAN;IAEAN,GAAG,CAACW,IAAJ,CAAS;MAAEC,GAAG,EAAE;IAAP,CAAT;EAEH,CATD,CASE,OAAOC,GAAP,EAAY;IACV,OAAOb,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB;MAACE,GAAG,EAAEA,GAAG,CAACE;IAAV,CAArB,CAAP;EACH;AACJ,CAbD"},"metadata":{},"sourceType":"module"}