{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\nextjs-ecommerce-master\\\\store\\\\GlobalState.js\";\nimport { createContext, useReducer, useEffect } from 'react';\nimport reducers from './Reducers';\nimport { getData } from '../utils/fetchData';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const DataContext = /*#__PURE__*/createContext();\nexport const DataProvider = ({\n  children\n}) => {\n  const initialState = {\n    notify: {},\n    auth: {},\n    cart: [],\n    modal: [],\n    orders: [],\n    users: [],\n    categories: []\n  };\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(reducers, initialState);\n  const {\n    cart,\n    auth\n  } = state;\n  useEffect(() => {\n    const firstLogin = localStorage.getItem(\"firstLogin\");\n\n    if (firstLogin) {\n      getData('auth/accessToken').then(res => {\n        if (res.err) return localStorage.removeItem(\"firstLogin\");\n        dispatch({\n          type: \"AUTH\",\n          payload: {\n            token: res.access_token,\n            user: res.user\n          }\n        });\n      });\n    }\n\n    getData('categories').then(res => {\n      if (res.err) return dispatch({\n        type: 'NOTIFY',\n        payload: {\n          error: res.err\n        }\n      });\n      dispatch({\n        type: \"ADD_CATEGORIES\",\n        payload: res.categories\n      });\n    });\n  }, []);\n  useEffect(() => {\n    const __next__cart01__devat = JSON.parse(localStorage.getItem('__next__cart01__devat'));\n\n    if (__next__cart01__devat) dispatch({\n      type: 'ADD_CART',\n      payload: __next__cart01__devat\n    });\n  }, []);\n  useEffect(() => {\n    localStorage.setItem('__next__cart01__devat', JSON.stringify(cart));\n  }, [cart]);\n  useEffect(() => {\n    if (auth.token) {\n      getData('order', auth.token).then(res => {\n        if (res.err) return dispatch({\n          type: 'NOTIFY',\n          payload: {\n            error: res.err\n          }\n        });\n        dispatch({\n          type: 'ADD_ORDERS',\n          payload: res.orders\n        });\n      });\n\n      if (auth.user.role === 'admin') {\n        getData('user', auth.token).then(res => {\n          if (res.err) return dispatch({\n            type: 'NOTIFY',\n            payload: {\n              error: res.err\n            }\n          });\n          dispatch({\n            type: 'ADD_USERS',\n            payload: res.users\n          });\n        });\n      }\n    } else {\n      dispatch({\n        type: 'ADD_ORDERS',\n        payload: []\n      });\n      dispatch({\n        type: 'ADD_USERS',\n        payload: []\n      });\n    }\n  }, [auth.token]);\n  return /*#__PURE__*/_jsxDEV(DataContext.Provider, {\n    value: {\n      state,\n      dispatch\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 9\n  }, this);\n};","map":{"version":3,"names":["createContext","useReducer","useEffect","reducers","getData","DataContext","DataProvider","children","initialState","notify","auth","cart","modal","orders","users","categories","state","dispatch","firstLogin","localStorage","getItem","then","res","err","removeItem","type","payload","token","access_token","user","error","__next__cart01__devat","JSON","parse","setItem","stringify","role"],"sources":["C:/Users/DELL/Desktop/nextjs-ecommerce-master/store/GlobalState.js"],"sourcesContent":["import { createContext, useReducer, useEffect } from 'react'\nimport reducers from './Reducers'\nimport { getData } from '../utils/fetchData'\n\n\nexport const DataContext = createContext()\n\n\nexport const DataProvider = ({children}) => {\n    const initialState = { \n        notify: {}, auth: {}, cart: [], modal: [], orders: [], users: [], categories: []\n    }\n\n    const [state, dispatch] = useReducer(reducers, initialState)\n    const { cart, auth } = state\n\n    useEffect(() => {\n        const firstLogin = localStorage.getItem(\"firstLogin\");\n        if(firstLogin){\n            getData('auth/accessToken').then(res => {\n                if(res.err) return localStorage.removeItem(\"firstLogin\")\n                dispatch({ \n                    type: \"AUTH\",\n                    payload: {\n                        token: res.access_token,\n                        user: res.user\n                    }\n                })\n            })\n        }\n\n        getData('categories').then(res => {\n            if(res.err) return dispatch({type: 'NOTIFY', payload: {error: res.err}})\n\n            dispatch({ \n                type: \"ADD_CATEGORIES\",\n                payload: res.categories\n            })\n        })\n        \n    },[])\n\n    useEffect(() => {\n        const __next__cart01__devat = JSON.parse(localStorage.getItem('__next__cart01__devat'))\n\n        if(__next__cart01__devat) dispatch({ type: 'ADD_CART', payload: __next__cart01__devat })\n    }, [])\n\n    useEffect(() => {\n        localStorage.setItem('__next__cart01__devat', JSON.stringify(cart))\n    }, [cart])\n\n    useEffect(() => {\n        if(auth.token){\n            getData('order', auth.token)\n            .then(res => {\n                if(res.err) return dispatch({type: 'NOTIFY', payload: {error: res.err}})\n                \n                dispatch({type: 'ADD_ORDERS', payload: res.orders})\n            })\n\n            if(auth.user.role === 'admin'){\n                getData('user', auth.token)\n                .then(res => {\n                    if(res.err) return dispatch({type: 'NOTIFY', payload: {error: res.err}})\n                \n                    dispatch({type: 'ADD_USERS', payload: res.users})\n                })\n            }\n        }else{\n            dispatch({type: 'ADD_ORDERS', payload: []})\n            dispatch({type: 'ADD_USERS', payload: []})\n        }\n    },[auth.token])\n\n    return(\n        <DataContext.Provider value={{state, dispatch}}>\n            {children}\n        </DataContext.Provider>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}