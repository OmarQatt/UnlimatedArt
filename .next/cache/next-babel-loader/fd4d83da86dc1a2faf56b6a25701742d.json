{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\nextjs-ecommerce-master\\\\components\\\\paypalBtn.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { useEffect, useRef, useContext } from 'react';\nimport { patchData } from '../utils/fetchData';\nimport { DataContext } from '../store/GlobalState';\nimport { updateItem } from '../store/Actions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar paypalBtn = function paypalBtn(_ref) {\n  _s();\n\n  var order = _ref.order;\n  var refPaypalBtn = useRef();\n\n  var _useContext = useContext(DataContext),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch;\n\n  var auth = state.auth,\n      orders = state.orders;\n  useEffect(function () {\n    paypal.Buttons({\n      createOrder: function createOrder(data, actions) {\n        // This function sets up the details of the transaction, including the amount and line item details.\n        return actions.order.create({\n          purchase_units: [{\n            amount: {\n              value: order.total\n            }\n          }]\n        });\n      },\n      onApprove: function onApprove(data, actions) {\n        // This function captures the funds from the transaction.\n        dispatch({\n          type: 'NOTIFY',\n          payload: {\n            loading: true\n          }\n        });\n        return actions.order.capture().then(function (details) {\n          patchData(\"order/payment/\".concat(order._id), {\n            paymentId: details.payer.payer_id\n          }, auth.token).then(function (res) {\n            if (res.err) return dispatch({\n              type: 'NOTIFY',\n              payload: {\n                error: res.err\n              }\n            });\n            dispatch(updateItem(orders, order._id, _objectSpread(_objectSpread({}, order), {}, {\n              paid: true,\n              dateOfPayment: details.create_time,\n              paymentId: details.payer.payer_id,\n              method: 'Paypal'\n            }), 'ADD_ORDERS'));\n            return dispatch({\n              type: 'NOTIFY',\n              payload: {\n                success: res.msg\n              }\n            });\n          }); // This function shows a transaction success message to your buyer.\n        });\n      }\n    }).render(refPaypalBtn.current);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: refPaypalBtn\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(paypalBtn, \"Q7r/pGe3Y/9OcyIGHlqtGtU0XNM=\");\n\nexport default paypalBtn;","map":{"version":3,"names":["useEffect","useRef","useContext","patchData","DataContext","updateItem","paypalBtn","order","refPaypalBtn","state","dispatch","auth","orders","paypal","Buttons","createOrder","data","actions","create","purchase_units","amount","value","total","onApprove","type","payload","loading","capture","then","details","_id","paymentId","payer","payer_id","token","res","err","error","paid","dateOfPayment","create_time","method","success","msg","render","current"],"sources":["C:/Users/DELL/Desktop/nextjs-ecommerce-master/components/paypalBtn.js"],"sourcesContent":["import { useEffect, useRef, useContext } from 'react'\nimport { patchData } from '../utils/fetchData'\nimport {DataContext} from '../store/GlobalState'\nimport {updateItem} from '../store/Actions'\n\nconst paypalBtn = ({order}) => {\n    const refPaypalBtn = useRef()\n    const {state, dispatch} = useContext(DataContext)\n    const { auth, orders} = state\n\n    useEffect(() => {\n        paypal.Buttons({\n            createOrder: function(data, actions) {\n              // This function sets up the details of the transaction, including the amount and line item details.\n              return actions.order.create({\n                purchase_units: [{\n                  amount: {\n                    value: order.total\n                  }\n                }]\n              });\n            },\n            onApprove: function(data, actions) {\n              // This function captures the funds from the transaction.\n              dispatch({ type: 'NOTIFY', payload: {loading: true} })\n\n              return actions.order.capture().then(function(details) {\n\n                patchData(`order/payment/${order._id}`, {\n                  paymentId: details.payer.payer_id\n                }, auth.token)\n                .then(res => {\n                  if(res.err) return dispatch({ type: 'NOTIFY', payload: {error: res.err} })\n                  \n                  dispatch(updateItem(orders, order._id, {\n                    ...order, \n                    paid: true, dateOfPayment: details.create_time,\n                    paymentId: details.payer.payer_id, method: 'Paypal'\n                  }, 'ADD_ORDERS'))\n\n                  return dispatch({ type: 'NOTIFY', payload: {success: res.msg} })\n                })\n                // This function shows a transaction success message to your buyer.\n              });\n            }\n        }).render(refPaypalBtn.current);\n    },[])\n\n    return(\n        <div ref={refPaypalBtn}></div>\n    )\n}\n\nexport default paypalBtn"],"mappings":";;;;;;;;;;AAAA,SAASA,SAAT,EAAoBC,MAApB,EAA4BC,UAA5B,QAA8C,OAA9C;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAAQC,WAAR,QAA0B,sBAA1B;AACA,SAAQC,UAAR,QAAyB,kBAAzB;;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY,OAAa;EAAA;;EAAA,IAAXC,KAAW,QAAXA,KAAW;EAC3B,IAAMC,YAAY,GAAGP,MAAM,EAA3B;;EACA,kBAA0BC,UAAU,CAACE,WAAD,CAApC;EAAA,IAAOK,KAAP,eAAOA,KAAP;EAAA,IAAcC,QAAd,eAAcA,QAAd;;EACA,IAAQC,IAAR,GAAwBF,KAAxB,CAAQE,IAAR;EAAA,IAAcC,MAAd,GAAwBH,KAAxB,CAAcG,MAAd;EAEAZ,SAAS,CAAC,YAAM;IACZa,MAAM,CAACC,OAAP,CAAe;MACXC,WAAW,EAAE,qBAASC,IAAT,EAAeC,OAAf,EAAwB;QACnC;QACA,OAAOA,OAAO,CAACV,KAAR,CAAcW,MAAd,CAAqB;UAC1BC,cAAc,EAAE,CAAC;YACfC,MAAM,EAAE;cACNC,KAAK,EAAEd,KAAK,CAACe;YADP;UADO,CAAD;QADU,CAArB,CAAP;MAOD,CAVU;MAWXC,SAAS,EAAE,mBAASP,IAAT,EAAeC,OAAf,EAAwB;QACjC;QACAP,QAAQ,CAAC;UAAEc,IAAI,EAAE,QAAR;UAAkBC,OAAO,EAAE;YAACC,OAAO,EAAE;UAAV;QAA3B,CAAD,CAAR;QAEA,OAAOT,OAAO,CAACV,KAAR,CAAcoB,OAAd,GAAwBC,IAAxB,CAA6B,UAASC,OAAT,EAAkB;UAEpD1B,SAAS,yBAAkBI,KAAK,CAACuB,GAAxB,GAA+B;YACtCC,SAAS,EAAEF,OAAO,CAACG,KAAR,CAAcC;UADa,CAA/B,EAENtB,IAAI,CAACuB,KAFC,CAAT,CAGCN,IAHD,CAGM,UAAAO,GAAG,EAAI;YACX,IAAGA,GAAG,CAACC,GAAP,EAAY,OAAO1B,QAAQ,CAAC;cAAEc,IAAI,EAAE,QAAR;cAAkBC,OAAO,EAAE;gBAACY,KAAK,EAAEF,GAAG,CAACC;cAAZ;YAA3B,CAAD,CAAf;YAEZ1B,QAAQ,CAACL,UAAU,CAACO,MAAD,EAASL,KAAK,CAACuB,GAAf,kCACdvB,KADc;cAEjB+B,IAAI,EAAE,IAFW;cAELC,aAAa,EAAEV,OAAO,CAACW,WAFlB;cAGjBT,SAAS,EAAEF,OAAO,CAACG,KAAR,CAAcC,QAHR;cAGkBQ,MAAM,EAAE;YAH1B,IAIhB,YAJgB,CAAX,CAAR;YAMA,OAAO/B,QAAQ,CAAC;cAAEc,IAAI,EAAE,QAAR;cAAkBC,OAAO,EAAE;gBAACiB,OAAO,EAAEP,GAAG,CAACQ;cAAd;YAA3B,CAAD,CAAf;UACD,CAbD,EAFoD,CAgBpD;QACD,CAjBM,CAAP;MAkBD;IAjCU,CAAf,EAkCGC,MAlCH,CAkCUpC,YAAY,CAACqC,OAlCvB;EAmCH,CApCQ,EAoCP,EApCO,CAAT;EAsCA,oBACI;IAAK,GAAG,EAAErC;EAAV;IAAA;IAAA;IAAA;EAAA,SADJ;AAGH,CA9CD;;GAAMF,S;;AAgDN,eAAeA,SAAf"},"metadata":{},"sourceType":"module"}